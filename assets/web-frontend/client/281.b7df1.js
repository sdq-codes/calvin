(this.webpackJsonp=this.webpackJsonp||[]).push([[281],{2590:function(e,t,n){e.exports={}},2748:function(e,t,n){"use strict";n(2590)},2749:function(e,t,n){e.exports={}},2848:function(e,t,n){"use strict";n(22);var l=n(1),o={name:"NumInput",props:{step:{type:Number,default:1},value:{type:[String,Number,Object],default:""},placeholder:{type:String,default:""},isInteger:{type:Boolean,default:!1},precision:{type:Number,default:-1},startWithZero:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxNumber:{type:[Number,String,null],default:null}},created(){this.inputRealValue=""},computed:{},methods:{isValidInput(e){const t=e+"",n=t.split("."),l=t.includes("."),o=t.startsWith("0"),r=this;const c=function(){if(!l&&(e.length>20||isNaN(e)))return{isValid:!1,msg:"校验数字长度不大于20位，或者不是数字"};if(o&&t[1]&&"."!==t[1])return{isValid:!1,msg:"0开头，第二位只能是小数点"};if(l){if(n.length>=3)return{isValid:!1,msg:"有多个小数点"};if(isNaN(n[0])||n[0].length>20||isNaN(n[1])&&""!==n[1])return{isValid:!1,msg:'小数点前不是数字, 小数点前超过20位 ，(小数点后不是数字，并且不是空字符串, "0." 这种情况)'};if(+r.precision>=0&&n[1].length>+r.precision)return{isValid:!1,msg:"小数点后位数大于precision"}}return{isValid:!0}}();return c.isValid||console.warn(`${e} 不是合法数字，原因：${c.msg}`),c.isValid},formateVal(e){const t=e+"";return t.includes(".")&&t.indexOf(".")===t.length-1?t.replace(".",""):t},inputHandle(e){const t=this.disThousand(e.target.value);this.isValidInput(t)?(this.setInputValue(t,e.target.value),this.inputRealValue=t,this.$emit("input",Object(l.X)(this.formateVal(t)),{isEnterKey:"Enter"===e.key||"Enter"===e.code})):this.setInputValue(this.inputRealValue)},focusHandle(){this.$emit("focus")},blurHandle(){this.$emit("blur")},setInputValue(e,t){const n=this.makeThousand(e);console.log("setInputValue",e,n);let l=null;if(e!==this.inputRealValue&&t){let e=this.$refs.input.selectionEnd;const o=t.length-e;l=n.length-o}this.$refs.input.value=n,null!==l&&this.$refs.input.setSelectionRange(l,l)},makeThousand(e){const t=e+"";if(!t)return"";const n=t.indexOf(".")===t.length-1,[l,o]=t.split(".");return`${l.replace(/\B(?=(\d{3})+(?!\d))/g,",")}${o||n?`.${o}`:""}`},disThousand:e=>e.replaceAll(",",""),isOverPrecision(e){const t=(e+"").split(".")[1];return!!t&&t.length>this.precision}},watch:{value(e,t){if(+e!=+this.inputRealValue||""===e){const t=e&&this.isOverPrecision(e)?(+e).toFixed(this.precision):e;this.inputRealValue=t,this.setInputValue(t)}}}},r=(n(2748),n(6)),component=Object(r.a)(o,(function(){var e=this;return(0,e._self._c)("input",{ref:"input",staticClass:"comp-num-input ibm-font",attrs:{type:"text",placeholder:e.placeholder,disabled:e.disabled},on:{input:e.inputHandle,focus:e.focusHandle,blur:e.blurHandle,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.inputHandle.apply(null,arguments)}}})}),[],!1,null,"ce6a0c50",null);t.a=component.exports},3038:function(e,t,n){"use strict";n(22);var l={name:"SearchSelect",model:{prop:"currentSelect",event:"selectchange"},props:{currentSelect:{type:Object,default:()=>({})},iconKey:{type:String,default:"iconLink"},vis:{type:Boolean,default:!1},search:{type:Boolean,default:!0},title:{type:String,default:""},options:{type:Array,default:()=>[]},inputPlaceholder:{type:String,default:"Search"},listKeyName:{type:String,default:"id"},searchKeyName:{type:String,default:"label"}},data:()=>({searchKey:""}),computed:{coinArr(){let e=this.options.filter((e=>{var t,n;return(null===(t=e[this.searchKeyName])||void 0===t?void 0:t.toLowerCase().includes(this.searchKey.toLowerCase()))||(null===(n=e.cryptoFullName)||void 0===n?void 0:n.toLowerCase().includes(this.searchKey.toLowerCase()))}));if(this.searchKey){const t=this.searchKey.toLowerCase();return[...e].sort(((e,n)=>{var l,o;const r=e[this.searchKeyName].toLowerCase(),c=n[this.searchKeyName].toLowerCase(),d=null===(l=e.cryptoFullName)||void 0===l?void 0:l.toLowerCase(),v=null===(o=n.cryptoFullName)||void 0===o?void 0:o.toLowerCase(),m=r===t||d===t,_=c===t||v===t,h=r.includes(t)||d.includes(t),y=c.includes(t)||v.includes(t);return m&&!_?-1:!m&&_?1:m&&_?0:h&&!y?-1:!h&&y?1:0}))}return e}},mounted(){},beforeDestroy(){document.documentElement.style.height="auto",document.body.style.height="auto",document.documentElement.style.overflow="visible",document.body.style.overflow="visible"},methods:{selectCoin(e){this.$emit("selectchange",e,this.currentSelect),this.$emit("update:vis",!1)},closeDialog(){this.$emit("update:vis",!1)}},watch:{vis(e,t){e&&(this.searchKey="")},options(e,t){this.coinArr=e.slice(0),this.$emit("selectchange",e[0],void 0)}}},o=(n(3111),n(6)),component=Object(o.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"r-search-select"},[t("div",{staticClass:"coinSelect__titBox"},[e.search?t("div",{staticClass:"search__box"},[t("i",{staticClass:"el-icon-search search__icon"}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKey,expression:"searchKey"}],ref:"input",staticClass:"search__input ibm-font",attrs:{type:"text",placeholder:e.inputPlaceholder},domProps:{value:e.searchKey},on:{input:function(t){t.target.composing||(e.searchKey=t.target.value)}}})]):e._e()]),e._v(" "),t("r-virtual-list",{attrs:{data:e.coinArr,"item-height":50,"wrapper-class":"list__coin","wrapper-height":"344","key-str":e.listKeyName},scopedSlots:e._u([{key:"option",fn:function(n){let{optionData:l}=n;return[t("div",{on:{click:function(t){return e.selectCoin(l)}}},[e._t("default",(function(){return[t("img",{staticClass:"logo__coin",attrs:{src:l?l[e.iconKey]:"",alt:"logo"}}),e._v(" "),t("span",{staticClass:"label__simpleCoin"},[e._v(e._s(l?l.label:""))])]}),{data:l,searchKey:e.searchKey})],2)]}}],null,!0)})],1)}),[],!1,null,"c3578dc8",null);t.a=component.exports},3111:function(e,t,n){"use strict";n(2749)},3804:function(e,t,n){e.exports={}},3805:function(e,t,n){e.exports={}},5087:function(e,t){e.exports={functional:!0,render(e,t){const{_c:n,_v:l,data:data,children:o=[]}=t,{class:r,staticClass:c,style:style,staticStyle:d,attrs:v={},...m}=data;return n("svg",{class:[r,c],style:[style,d],attrs:Object.assign({width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v),...m},o.concat([n("path",{attrs:{d:"M17.5 10.25L13.75 6.5L12.8687 7.38125L15.1062 9.625H2.5V10.875H15.1062L12.8687 13.1188L13.75 14L17.5 10.25Z",fill:"#86939B"}})]))}}},5088:function(e,t,n){"use strict";n(3804)},5089:function(e,t,n){"use strict";n(3805)},5258:function(e,t,n){"use strict";n.r(t);n(22);var l=n(14),o=n(46),r=n(29),c=n.n(r),d=n(74),v=n(8),m=n(19),_=n(2848),h=n(3038),y=n(5087),w=n.n(y),f=n(3261),C=n.n(f),S=Object(l.b)({mixins:[d.a],components:{NumInput:_.a,SearchSelect:h.a,IconBuySellArrow:w.a,IconBuySellGo:C.a},props:{globalBuySellAvailable:{type:Boolean,default:!1}},setup(){const e=Object(l.z)(),t=Object(l.x)(),{$t:n}=Object(l.s)(),r=Object(l.o)([]),d=Object(l.o)([]),_=Object(l.o)({}),h=Object(l.o)({}),y=Object(l.o)(!1),w=Object(l.o)(!1),f=Object(l.o)(null),C=Object(l.o)({amount:"",receiveAmount:""}),S=Object(l.o)(!1),O=Object(l.o)(!1),A=Object(l.o)(null),x=Object(l.o)(!1),N=Object(l.o)(null),T=Object(l.a)((()=>e.state.locale)),k=Object(l.a)((()=>e.getters["account/fiatWalletListIsPrivate"])),$=Object(l.a)((()=>k.value?d.value.filter((e=>{var t;return!(null!==(t=k.value.map)&&void 0!==t&&t.has(e.coinId))})):[])),j=Object(l.a)((()=>{if(!f.value||!N.value||+f.value.amount>0)return"";const{receiveAmount:e}=f.value,{channelMaxAmount:t,channelMinAmount:l}=N.value;return+e>+t?`${n("index.buy_sell_wrapper.the_maximum_amount")}${L(t)} ${h.value.label}`:+e<+l?`${n("index.buy_sell_wrapper.the_minimum_amount")}${L(l)} ${h.value.label}`:void 0})),I=Object(l.a)((()=>{if(!f.value||!N.value||+f.value.receiveAmount>0)return"";const{amount:e}=f.value,{channelMaxAmount:t,channelMinAmount:l}=N.value;return+e>+t?`${n("index.buy_sell_wrapper.the_maximum_amount")}${L(t)} ${_.value.label}`:+e<+l?`${n("index.buy_sell_wrapper.the_minimum_amount")}${L(l)} ${_.value.label}`:void 0})),L=e=>{const t=e+"";if(!t)return"";const n=t.indexOf(".")===t.length-1,[l,o]=t.split(".");return`${l.replace(/\B(?=(\d{3})+(?!\d))/g,",")}${o||n?`.${o}`:""}`};Object(l.A)(h,(e=>{(async e=>{const t=await Object(v.a)({url:"/gw-api/buy-sell-crypto/fiat",params:{type:"buy",crypto:e}});null!=t&&t.success&&(r.value=c()(t.data,"availableListWhenBuy",[]).map((e=>({label:e.tickerSymbol,value:e.tickerSymbol,id:e.id}))),r.value.length&&(_.value=r.value[0]))})(e.label)}));const F=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?_.value=r.value.find((t=>t.value===e)):r.value.find((e=>e.value===_.value.label))||V()},V=()=>{const e={en:"USD",cn:"USD",jp:"JPY",vn:"VND",ru:"RUB",tr:"TRY",es:"EUR",br:"EUR",cn_tw:"TWD"}[T.value]||"USD";_.value=r.value.find((t=>t.value===e))||r.value[0]||{}},B=(e,t,n)=>{N.value=null,"amount"===e?(C.value.amount=t,C.value.receiveAmount=""):"receiveAmount"===e&&(C.value.amount="",C.value.receiveAmount=t),0!=+t&&(null!=n&&n.isEnterKey?E(e):K(e))},K=e=>{A.value&&(clearTimeout(A.value),A.value=null),A.value=setTimeout((()=>{E(e)}),1e3)},E=async e=>{A.value&&(clearTimeout(A.value),A.value=null),("amount"!==e||C.value.amount)&&("receiveAmount"!==e||C.value.receiveAmount)&&(x.value=!0,await D(e),x.value=!1)},D=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"amount";N.value=null;const n={cryptoCurrency:h.value.value,fiatCurrency:_.value.value,fiatAmount:0,cryptoAmount:0};if("amount"===t?(n.fiatAmount=C.value.amount,n.cryptoAmount=0,f.value={amount:C.value.amount,receiveAmount:0}):"receiveAmount"===t&&(n.fiatAmount=0,n.cryptoAmount=C.value.receiveAmount,f.value={amount:0,receiveAmount:C.value.receiveAmount}),Object.keys(n).some((e=>void 0===n[e]||null===n[e]||""===n[e])))return;const l=await Object(v.a)({method:"POST",url:"/gw-api/buy-sell-crypto/wallet-quote/v2",data:n});if(null==l||!l.success)return;const r=((null==l||null===(e=l.data)||void 0===e?void 0:e.list)||[]).filter((e=>e.cryptoAmount)).map((e=>(e.receiveAmount=e.cryptoAmount,e.orderAmount=+Object(o.a)(+e.fiatAmount).divide(+e.receiveAmount),e.receiveAmountFormated=Object(o.a)(e.receiveAmount).format({thousandSeparated:!0}),e)));r.length>0?R(r[0]):R(null)},R=e=>{e&&"--"!==e.receiveAmountFormated?(N.value=e,C.value.receiveAmount=e.receiveAmount,C.value.amount=e.fiatAmount):(N.value=null,C.value.amount="",C.value.receiveAmount="")};return Object(l.k)((()=>{(async e=>{const t=await Object(v.a)({url:"/gw-api/buy-sell-crypto/crypto",params:{type:"buy"},cache:{ttl:3e5,interpretHeader:!1}});null!=t&&t.success&&(d.value=c()(t.data,"availableListWhenBuy",[]).map((e=>({label:e.name,value:e.name,coinId:e.coinId,id:e.id,iconLink:e.iconLink,fullName:e.fullName}))),d.value.length&&(h.value=d.value[0]))})()})),{lodashGet:c.a,fiatJSON:m.E,currencyArr:r,buyFormData:C,focusInputOne:S,focusInputTwo:O,showOneCoin:y,showTwoCoin:w,currTwoSelect:h,currOneSelect:_,providerLoading:x,visibleCoinArr:$,receiveAmountErrTip:j,amountErrTip:I,onNumInput:B,onOneChangeInputFocus:e=>{S.value=!!e},onOneCoinDropdownClickOutside:e=>{y.value=!1},onOneSwitchShowCoinSelect:()=>{x.value||(y.value=!y.value)},onOneSelectChange:async(e,t)=>{void 0!==e&&(null==e?void 0:e.label)!==(null==t?void 0:t.label)&&(y.value=!1,N.value=null,_.value.label?F(e.label,!!t):V(),C.value.amount&&B("amount",C.value.amount,{isEnterKey:!0}))},onTwoChangeInputFocus:e=>{O.value=!!e},onTwoCoinDropdownClickOutside:e=>{w.value=!1},onTwoSwitchShowCoinSelect:()=>{x.value||(w.value=!w.value)},onTwoSelectChange:async(e,t)=>{void 0!==e&&(null==e?void 0:e.label)!==(null==t?void 0:t.label)&&(w.value=!1,N.value=null,h.value=$.value.find((t=>t.value===e.value)))},onNavigateTo:()=>{t.push({path:`/buy-sell/${T.value}`,query:{type:"buy",coin:h.value.value,currency:_.value.value,amount:C.value.amount}})}}}}),O=S,A=(n(5088),n(5089),n(6)),component=Object(A.a)(O,(function(){var e,t,n,l=this,o=l._self._c;l._self._setupProxy;return o("div",{directives:[{name:"show",rawName:"v-show",value:l.globalBuySellAvailable,expression:"globalBuySellAvailable"}],staticClass:"buy-sell-wrapper"},[o("div",{staticClass:"buy-sell-container"},[o("div",{staticClass:"head"},[l._v(l._s(l.$t("index.buy_sell_wrapper.head")))]),l._v(" "),o("div",{staticClass:"buy-sell-content"},[o("div",{staticClass:"dealForm__item"},[o("div",{staticClass:"dealForm__item--content item__content--main",class:{"item__content--loading":l.providerLoading,"item__content--active":l.focusInputOne}},[o("div",{staticClass:"dealForm__item--labelWrapper"},[o("div",{staticClass:"dealForm__item--label"},[o("div",{staticClass:"item__label--text"},[l._v(l._s(l.$t("index.buy_sell_wrapper.pay")))])]),l._v(" "),o("NumInput",{staticClass:"input__currency",attrs:{value:l.buyFormData.amount,precision:10,placeholder:l.$t("index.buy_sell_wrapper.enter_amount"),disabled:l.providerLoading},on:{input:(e,t)=>{l.onNumInput("amount",e,t)},focus:function(e){return l.onOneChangeInputFocus(!0)},blur:function(e){return l.onOneChangeInputFocus(!1)}}})],1),l._v(" "),o("div",{ref:"coinLeftSelectBtnRef",staticClass:"item__currency",on:{click:l.onOneSwitchShowCoinSelect}},[o("div",{staticClass:"logo__currency"},[o("div",{directives:[{name:"show",rawName:"v-show",value:null===(e=l.currOneSelect)||void 0===e?void 0:e.label,expression:"currOneSelect?.label"}],staticClass:"fiat__logo"},[l._v("\n                "+l._s(l.fiatJSON[l.lodashGet(l.currOneSelect,"label")])+"\n              ")]),l._v(" "),o("span",{staticClass:"logo__currencyTxt"},[l._v(l._s(l.lodashGet(l.currOneSelect,"label","")))]),l._v(" "),o("r-icon",{class:l.showOneCoin?"dealForm__icon--arrow-up":"dealForm__icon--arrow-down",attrs:{name:"icon-actions_select_down"}})],1)]),l._v(" "),o("transition",{attrs:{name:"el-zoom-in-top"}},[o("SearchSelect",{directives:[{name:"show",rawName:"v-show",value:l.showOneCoin,expression:"showOneCoin"},{name:"clickoutside",rawName:"v-clickoutside",value:l.onOneCoinDropdownClickOutside,expression:"onOneCoinDropdownClickOutside"}],staticClass:"coin-dropdown",attrs:{options:l.currencyArr,"input-placeholder":l.$t("index.buy_sell_wrapper.search")},on:{selectchange:l.onOneSelectChange},scopedSlots:l._u([{key:"default",fn:function(e){var t,n;let{data:data}=e;return[o("div",{staticClass:"coin-dropdown_item--wrapper",class:{"coin-dropdown_item--selected":(null===(t=l.currOneSelect)||void 0===t?void 0:t.id)===(null==data?void 0:data.id)}},[o("div",{staticClass:"coin-dropdown_item--left"},[o("div",{staticClass:"fiat__logo"},[l._v(l._s(l.fiatJSON[l.lodashGet(data,"label","")]||"$"))]),l._v(" "),o("span",{staticClass:"label__coinSelect"},[l._v(l._s(l.lodashGet(data,"label","")))]),l._v(" "),o("span",{staticClass:"label__fullName"},[l._v(l._s(l.lodashGet(data,"fullName","")))])]),l._v(" "),o("r-icon",{directives:[{name:"show",rawName:"v-show",value:(null===(n=l.currOneSelect)||void 0===n?void 0:n.id)===(null==data?void 0:data.id),expression:"currOneSelect?.id === data?.id"}],attrs:{name:"icon-checkmark"}})],1)]}}])})],1)],1),l._v(" "),o("div",{staticClass:"err-tip"},[l.amountErrTip?o("span",[l._v(l._s(l.amountErrTip))]):l._e()])]),l._v(" "),l.providerLoading?o("div",{staticClass:"icon-get"},[o("span",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],attrs:{"element-loading-spinner":"el-icon-loading"}})]):o("IconBuySellArrow",{staticClass:"icon-get"}),l._v(" "),o("div",{staticClass:"dealForm__item"},[o("div",{staticClass:"dealForm__item--content item__content--receive",class:{"item__content--loading":l.providerLoading,"item__content--active":l.focusInputTwo}},[o("div",{staticClass:"dealForm__item--labelWrapper"},[o("div",{staticClass:"dealForm__item--label"},[o("div",{staticClass:"item__label--text"},[l._v(l._s(l.$t("index.buy_sell_wrapper.receive")))])]),l._v(" "),o("NumInput",{staticClass:"input__currency",attrs:{value:l.buyFormData.receiveAmount,precision:10,placeholder:l.$t("index.buy_sell_wrapper.enter_amount"),disabled:l.providerLoading},on:{input:(e,t)=>{l.onNumInput("receiveAmount",e,t)},focus:function(e){return l.onTwoChangeInputFocus(!0)},blur:function(e){return l.onTwoChangeInputFocus(!1)}}})],1),l._v(" "),o("div",{ref:"coinRightSelectBtnRef",staticClass:"item__currency",on:{click:l.onTwoSwitchShowCoinSelect}},[o("div",{staticClass:"logo__currency"},[o("cdn-img",{directives:[{name:"show",rawName:"v-show",value:null===(t=l.currTwoSelect)||void 0===t?void 0:t.iconLink,expression:"currTwoSelect?.iconLink"}],staticClass:"logo__coin",attrs:{src:null===(n=l.currTwoSelect)||void 0===n?void 0:n.iconLink}}),l._v(" "),o("span",{staticClass:"logo__currencyTxt"},[l._v(l._s(l.lodashGet(l.currTwoSelect,"label","")))]),l._v(" "),o("r-icon",{class:l.showTwoCoin?"dealForm__icon--arrow-up":"dealForm__icon--arrow-down",attrs:{name:"icon-actions_select_down"}})],1)]),l._v(" "),o("transition",{attrs:{name:"el-zoom-in-top"}},[o("SearchSelect",{directives:[{name:"show",rawName:"v-show",value:l.showTwoCoin,expression:"showTwoCoin"},{name:"clickoutside",rawName:"v-clickoutside",value:l.onTwoCoinDropdownClickOutside,expression:"onTwoCoinDropdownClickOutside"}],staticClass:"coin-dropdown",attrs:{options:l.visibleCoinArr,"input-placeholder":l.$t("index.buy_sell_wrapper.search")},on:{selectchange:l.onTwoSelectChange},scopedSlots:l._u([{key:"default",fn:function(e){var t,n;let{data:data}=e;return[o("div",{staticClass:"coin-dropdown_item--wrapper",class:{"coin-dropdown_item--selected":(null===(t=l.currTwoSelect)||void 0===t?void 0:t.id)===(null==data?void 0:data.id)}},[o("div",{staticClass:"coin-dropdown_item--left"},[o("cdn-img",{staticClass:"logo__coin",attrs:{src:l.lodashGet(data,"iconLink","")}}),l._v(" "),o("span",{staticClass:"label__coinSelect"},[l._v(l._s(l.lodashGet(data,"label","")))]),l._v(" "),o("span",{staticClass:"label__fullName"},[l._v(l._s(l.lodashGet(data,"fullName","")))])],1),l._v(" "),o("r-icon",{directives:[{name:"show",rawName:"v-show",value:(null===(n=l.currTwoSelect)||void 0===n?void 0:n.id)===(null==data?void 0:data.id),expression:"currTwoSelect?.id === data?.id"}],attrs:{name:"icon-checkmark"}})],1)]}}])})],1)],1),l._v(" "),o("div",{staticClass:"err-tip"},[l.receiveAmountErrTip?o("span",[l._v(l._s(l.receiveAmountErrTip))]):l._e()])]),l._v(" "),o("r-button2",{staticClass:"icon-go-wrapper",attrs:{type:"primary"},on:{click:l.onNavigateTo}},[o("IconBuySellGo",{staticClass:"icon-go"})],1)],1)])])}),[],!1,null,"0c22413c",null);t.default=component.exports}}]);